#!/usr/bin/env python3
"""
–°–∫—Ä–∏–ø—Ç –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è —Ç–µ—Å—Ç–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö –≤ –±–∞–∑—É
"""

import sys
import os
sys.path.append(os.path.dirname(os.path.abspath(__file__)))

from app.core.database import SessionLocal, engine
from app.models.product import Product
from sqlalchemy.orm import Session
from PIL import Image, ImageDraw, ImageFont
import io

def create_test_image(text, filename, size=(400, 300)):
    """–°–æ–∑–¥–∞–µ—Ç —Ç–µ—Å—Ç–æ–≤–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Å —Ç–µ–∫—Å—Ç–æ–º"""
    # –°–æ–∑–¥–∞–µ–º –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ
    img = Image.new('RGB', size, color='#f0f0f0')
    draw = ImageDraw.Draw(img)
    
    # –î–æ–±–∞–≤–ª—è–µ–º —Ç–µ–∫—Å—Ç
    try:
        # –ü—ã—Ç–∞–µ–º—Å—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å–∏—Å—Ç–µ–º–Ω—ã–π —à—Ä–∏—Ñ—Ç
        font = ImageFont.truetype("arial.ttf", 24)
    except:
        # –ï—Å–ª–∏ –Ω–µ –ø–æ–ª—É—á–∏–ª–æ—Å—å, –∏—Å–ø–æ–ª—å–∑—É–µ–º —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π
        font = ImageFont.load_default()
    
    # –¶–µ–Ω—Ç—Ä–∏—Ä—É–µ–º —Ç–µ–∫—Å—Ç
    bbox = draw.textbbox((0, 0), text, font=font)
    text_width = bbox[2] - bbox[0]
    text_height = bbox[3] - bbox[1]
    
    x = (size[0] - text_width) // 2
    y = (size[1] - text_height) // 2
    
    # –†–∏—Å—É–µ–º —Ç–µ–∫—Å—Ç
    draw.text((x, y), text, fill='#333333', font=font)
    
    # –°–æ—Ö—Ä–∞–Ω—è–µ–º –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ
    os.makedirs(os.path.dirname(filename), exist_ok=True)
    img.save(filename, 'JPEG', quality=85)
    print(f"–°–æ–∑–¥–∞–Ω–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ: {filename}")

def add_test_products():
    """–î–æ–±–∞–≤–ª—è–µ—Ç —Ç–µ—Å—Ç–æ–≤—ã–µ –ø—Ä–æ–¥—É–∫—Ç—ã –≤ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö"""
    
    # –°–æ–∑–¥–∞–µ–º —Ç–∞–±–ª–∏—Ü—ã –µ—Å–ª–∏ –∏—Ö –Ω–µ—Ç
    from app.models import product, gallery, video, project, certificate, technology, page_content
    from app.core.database import Base
    Base.metadata.create_all(bind=engine)
    
    # –°–æ–∑–¥–∞–µ–º —Ç–µ—Å—Ç–æ–≤—ã–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –¥–ª—è –º–∞—Ç–µ—Ä–∏–∞–ª–æ–≤
    test_images = [
        ("uploads/products/nano_antibacterial.jpg", "NAS‚Ñ¢"),
        ("uploads/products/nano_scratch.jpg", "NSR‚Ñ¢"),
        ("uploads/products/advanced_pvd.jpg", "Advanced PVD"),
        ("uploads/products/artbrush.jpg", "ArtBrush‚Ñ¢"),
        ("uploads/products/patina.jpg", "Patina"),
        ("uploads/products/bead_blast.jpg", "Bead Blast"),
        ("uploads/products/hairline.jpg", "Hairline"),
        ("uploads/products/n8_mirror.jpg", "N8 Mirror"),
        ("uploads/products/metamorphose_3d.jpg", "Metamorphose 3D")
    ]
    
    for image_path, text in test_images:
        create_test_image(text, image_path)
    
    db = SessionLocal()
    
    try:
        # –ü—Ä–æ–≤–µ—Ä—è–µ–º, –µ—Å—Ç—å –ª–∏ —É–∂–µ –ø—Ä–æ–¥—É–∫—Ç—ã
        existing_products = db.query(Product).count()
        if existing_products > 0:
            print(f"–í –±–∞–∑–µ —É–∂–µ –µ—Å—Ç—å {existing_products} –ø—Ä–æ–¥—É–∫—Ç–æ–≤. –ü—Ä–æ–ø—É—Å–∫–∞–µ–º –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ.")
            return
        
        # –†–µ–∞–ª—å–Ω—ã–µ –º–∞—Ç–µ—Ä–∏–∞–ª—ã —Å —Å–∞–π—Ç–∞ Inox Metal Art
        test_products = [
            {
                "name": "Nano Antibacterial Surface (NAS‚Ñ¢)",
                "category": "–ó–∞—â–∏—Ç–Ω—ã–µ –ø–æ–∫—Ä—ã—Ç–∏—è",
                "description": "–£–Ω–∏–∫–∞–ª—å–Ω–æ–µ –ø–æ–∫—Ä—ã—Ç–∏–µ, —Å–æ—á–µ—Ç–∞—é—â–µ–µ –∞–Ω—Ç–∏–±–∞–∫—Ç–µ—Ä–∏–∞–ª—å–Ω—ã–µ –∏ —É—Å—Ç–æ–π—á–∏–≤—ã–µ –∫ –æ—Ç–ø–µ—á–∞—Ç–∫–∞–º –ø–∞–ª—å—Ü–µ–≤ —Å–≤–æ–π—Å—Ç–≤–∞. –ò–¥–µ–∞–ª—å–Ω–æ –ø–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è –º–µ—Å—Ç —Å –≤—ã—Å–æ–∫–∏–º–∏ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è–º–∏ –∫ –≥–∏–≥–∏–µ–Ω–µ, —Ç–∞–∫–∏—Ö –∫–∞–∫ –±–æ–ª—å–Ω–∏—Ü—ã, –∞—ç—Ä–æ–ø–æ—Ä—Ç—ã –∏ –ª–∏—Ñ—Ç—ã.",
                "features": ["–ê–Ω—Ç–∏–±–∞–∫—Ç–µ—Ä–∏–∞–ª—å–Ω—ã–µ —Å–≤–æ–π—Å—Ç–≤–∞", "–£—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å –∫ –æ—Ç–ø–µ—á–∞—Ç–∫–∞–º –ø–∞–ª—å—Ü–µ–≤", "–í—ã—Å–æ–∫–∏–µ –≥–∏–≥–∏–µ–Ω–∏—á–µ—Å–∫–∏–µ —Å—Ç–∞–Ω–¥–∞—Ä—Ç—ã", "–ò–¥–µ–∞–ª—å–Ω–æ –¥–ª—è –º–µ–¥–∏—Ü–∏–Ω—Å–∫–∏—Ö —É—á—Ä–µ–∂–¥–µ–Ω–∏–π"],
                "image_path": "uploads/products/nano_antibacterial.jpg",
                "status": "active"
            },
            {
                "name": "Nano Scratch Resistant (NSR‚Ñ¢)",
                "category": "–ó–∞—â–∏—Ç–Ω—ã–µ –ø–æ–∫—Ä—ã—Ç–∏—è",
                "description": "–ü–æ–∫—Ä—ã—Ç–∏–µ, –æ–±–µ—Å–ø–µ—á–∏–≤–∞—é—â–µ–µ –ø–æ–≤–µ—Ä—Ö–Ω–æ—Å—Ç—å, –≤ —á–µ—Ç—ã—Ä–µ —Ä–∞–∑–∞ –±–æ–ª–µ–µ —Ç–≤–µ—Ä–¥—É—é, —á–µ–º –æ–±—ã—á–Ω–∞—è –Ω–µ—Ä–∂–∞–≤–µ—é—â–∞—è —Å—Ç–∞–ª—å, —Å —Ç–≤–µ—Ä–¥–æ—Å—Ç—å—é 578 HV. –ò–¥–µ–∞–ª—å–Ω–æ –¥–ª—è –æ–±–ª–∞—Å—Ç–µ–π —Å —á–∞—Å—Ç—ã–º –∏–∑–Ω–æ—Å–æ–º.",
                "features": ["–¢–≤–µ—Ä–¥–æ—Å—Ç—å 578 HV", "–í 4 —Ä–∞–∑–∞ —Ç–≤–µ—Ä–∂–µ –æ–±—ã—á–Ω–æ–π —Å—Ç–∞–ª–∏", "–ò–¥–µ–∞–ª—å–Ω–æ –¥–ª—è –ª–∏—Ñ—Ç–æ–≤ –∏ –∫—É—Ö–æ–Ω—å", "–ó–∞—â–∏—Ç–∞ –æ—Ç —Ü–∞—Ä–∞–ø–∏–Ω"],
                "image_path": "uploads/products/nano_scratch.jpg",
                "status": "active"
            },
            {
                "name": "Advanced Ti (PVD) Coating",
                "category": "–î–µ–∫–æ—Ä–∞—Ç–∏–≤–Ω—ã–µ –ø–æ–∫—Ä—ã—Ç–∏—è",
                "description": "–°–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–π –ø—Ä–æ—Ü–µ—Å—Å PVD –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç —è—Ä–∫–∏–µ, —É—Å—Ç–æ–π—á–∏–≤—ã–µ –∫ –∫–æ—Ä—Ä–æ–∑–∏–∏ —Ü–≤–µ—Ç–∞, —Å–æ—Ö—Ä–∞–Ω—è—é—â–∏–µ —Å–≤–æ—é —è—Ä–∫–æ—Å—Ç—å –¥–µ—Å—è—Ç–∏–ª–µ—Ç–∏—è–º–∏. –ò–¥–µ–∞–ª—å–Ω–æ –¥–ª—è –ø—Ä–µ–º–∏–∞–ª—å–Ω—ã—Ö –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã—Ö –¥–∏–∑–∞–π–Ω–æ–≤.",
                "features": ["–Ø—Ä–∫–∏–µ –¥–µ–∫–æ—Ä–∞—Ç–∏–≤–Ω—ã–µ —Ü–≤–µ—Ç–∞", "–£—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å –∫ –∫–æ—Ä—Ä–æ–∑–∏–∏", "30+ –ª–µ—Ç –ø—Ä–æ–≤–µ—Ä–µ–Ω–Ω–æ–π –Ω–∞–¥–µ–∂–Ω–æ—Å—Ç–∏", "–ü—Ä–µ–º–∏–∞–ª—å–Ω–æ–µ –∫–∞—á–µ—Å—Ç–≤–æ"],
                "image_path": "uploads/products/advanced_pvd.jpg",
                "status": "active"
            },
            {
                "name": "ArtBrush‚Ñ¢",
                "category": "–î–µ–∫–æ—Ä–∞—Ç–∏–≤–Ω—ã–µ –ø–æ–∫—Ä—ã—Ç–∏—è",
                "description": "–†—É—á–Ω–∞—è –æ—Ç–¥–µ–ª–∫–∞ —Å –ø–æ—Ä–∞–∑–∏—Ç–µ–ª—å–Ω—ã–º 3D-—ç—Ñ—Ñ–µ–∫—Ç–æ–º, —Ä–∞–∑—Ä–∞–±–æ—Ç–∞–Ω–Ω–∞—è –¥–ª—è —Å–∫—Ä—ã—Ç–∏—è —Ü–∞—Ä–∞–ø–∏–Ω –≤ –º–µ—Å—Ç–∞—Ö —Å –≤—ã—Å–æ–∫–æ–π –ø—Ä–æ—Ö–æ–¥–∏–º–æ—Å—Ç—å—é. –°–æ—á–µ—Ç–∞–µ—Ç —Ä–µ–º–µ—Å–ª–µ–Ω–Ω–æ–µ –º–∞—Å—Ç–µ—Ä—Å—Ç–≤–æ –∏ –¥–æ–ª–≥–æ–≤–µ—á–Ω–æ—Å—Ç—å.",
                "features": ["3D-—ç—Ñ—Ñ–µ–∫—Ç", "–†—É—á–Ω–∞—è –æ—Ç–¥–µ–ª–∫–∞", "–°–∫—Ä—ã–≤–∞–µ—Ç —Ü–∞—Ä–∞–ø–∏–Ω—ã", "–®–∏—Ä–æ–∫–∏–π –≤—ã–±–æ—Ä PVD-—Ü–≤–µ—Ç–æ–≤"],
                "image_path": "uploads/products/artbrush.jpg",
                "status": "active"
            },
            {
                "name": "Patina",
                "category": "–î–µ–∫–æ—Ä–∞—Ç–∏–≤–Ω—ã–µ –ø–æ–∫—Ä—ã—Ç–∏—è",
                "description": "–ü–µ—Ä–µ–¥–∞–µ—Ç –≤–µ—á–Ω—É—é –∫—Ä–∞—Å–æ—Ç—É —Å–æ—Å—Ç–∞—Ä–µ–Ω–Ω–æ–≥–æ –º–µ—Ç–∞–ª–ª–∞ –∏–ª–∏ –∫–∞–º–Ω—è, —Å–æ–∑–¥–∞–≤–∞—è –æ—â—É—â–µ–Ω–∏–µ —Å–≤—è–∑–∏ –∏ –¥–æ–≤–µ—Ä–∏—è. –ò–¥–µ–∞–ª—å–Ω–æ –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö –∏ —ç–ª–µ–≥–∞–Ω—Ç–Ω—ã—Ö –∏–Ω—Ç–µ—Ä—å–µ—Ä–æ–≤.",
                "features": ["–°–æ—Å—Ç–∞—Ä–µ–Ω–Ω—ã–π —ç—Ñ—Ñ–µ–∫—Ç", "–í–∏–Ω—Ç–∞–∂–Ω—ã–π —Å—Ç–∏–ª—å", "–£–Ω–∏–∫–∞–ª—å–Ω–∞—è —Ç–µ–∫—Å—Ç—É—Ä–∞", "–≠–ª–µ–≥–∞–Ω—Ç–Ω–æ—Å—Ç—å"],
                "image_path": "uploads/products/patina.jpg",
                "status": "active"
            },
            {
                "name": "Bead Blast (BB)",
                "category": "–¢–µ–∫—Å—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –ø–æ–∫—Ä—ã—Ç–∏—è",
                "description": "–ú–∞—Ç–æ–≤–∞—è –æ—Ç–¥–µ–ª–∫–∞ —Å —Ä–∞–≤–Ω–æ–º–µ—Ä–Ω–æ–π —Ç–µ–∫—Å—Ç—É—Ä–æ–π, —Å–æ–∑–¥–∞—é—â–∞—è —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–π –∏ —ç–ª–µ–≥–∞–Ω—Ç–Ω—ã–π –≤–∏–¥. –û—Ç–ª–∏—á–Ω–æ –ø–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è —Ñ–∞—Å–∞–¥–æ–≤ –∏ –∏–Ω—Ç–µ—Ä—å–µ—Ä–æ–≤.",
                "features": ["–ú–∞—Ç–æ–≤–∞—è –æ—Ç–¥–µ–ª–∫–∞", "–†–∞–≤–Ω–æ–º–µ—Ä–Ω–∞—è —Ç–µ–∫—Å—Ç—É—Ä–∞", "–°–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–π –≤–∏–¥", "–£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–æ—Å—Ç—å"],
                "image_path": "uploads/products/bead_blast.jpg",
                "status": "active"
            },
            {
                "name": "Hairline (HL)",
                "category": "–¢–µ–∫—Å—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –ø–æ–∫—Ä—ã—Ç–∏—è",
                "description": "–ö–ª–∞—Å—Å–∏—á–µ—Å–∫–∞—è –ª–∏–Ω–µ–π–Ω–∞—è –æ—Ç–¥–µ–ª–∫–∞, —Å–æ–∑–¥–∞—é—â–∞—è —ç–ª–µ–≥–∞–Ω—Ç–Ω—ã–µ –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω—ã–µ –ª–∏–Ω–∏–∏. –®–∏—Ä–æ–∫–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ –ø—Ä–µ–º–∏–∞–ª—å–Ω—ã—Ö –ø—Ä–æ–µ–∫—Ç–∞—Ö.",
                "features": ["–õ–∏–Ω–µ–π–Ω–∞—è —Ç–µ–∫—Å—Ç—É—Ä–∞", "–ö–ª–∞—Å—Å–∏—á–µ—Å–∫–∏–π —Å—Ç–∏–ª—å", "–ü—Ä–µ–º–∏–∞–ª—å–Ω–æ–µ –∫–∞—á–µ—Å—Ç–≤–æ", "–≠–ª–µ–≥–∞–Ω—Ç–Ω–æ—Å—Ç—å"],
                "image_path": "uploads/products/hairline.jpg",
                "status": "active"
            },
            {
                "name": "N8 Mirror",
                "category": "–ó–µ—Ä–∫–∞–ª—å–Ω—ã–µ –ø–æ–∫—Ä—ã—Ç–∏—è",
                "description": "–í—ã—Å–æ–∫–æ–∫–∞—á–µ—Å—Ç–≤–µ–Ω–Ω–æ–µ –∑–µ—Ä–∫–∞–ª—å–Ω–æ–µ –ø–æ–∫—Ä—ã—Ç–∏–µ —Å –∏–¥–µ–∞–ª—å–Ω–æ–π –æ—Ç—Ä–∞–∂–∞—é—â–µ–π —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å—é. –°–æ–∑–¥–∞–µ—Ç —ç—Ñ—Ñ–µ–∫—Ç —Ä–æ—Å–∫–æ—à–∏ –∏ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–∞.",
                "features": ["–ó–µ—Ä–∫–∞–ª—å–Ω–∞—è –ø–æ–≤–µ—Ä—Ö–Ω–æ—Å—Ç—å", "–í—ã—Å–æ–∫–∞—è –æ—Ç—Ä–∞–∂–∞—é—â–∞—è —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å", "–†–æ—Å–∫–æ—à–Ω—ã–π –≤–∏–¥", "–†–∞—Å—à–∏—Ä–µ–Ω–∏–µ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–∞"],
                "image_path": "uploads/products/n8_mirror.jpg",
                "status": "active"
            },
            {
                "name": "Metamorphose 3D",
                "category": "3D —Ç–µ–∫—Å—Ç—É—Ä—ã",
                "description": "–ò–Ω–Ω–æ–≤–∞—Ü–∏–æ–Ω–Ω–∞—è 3D-—Ç–µ–∫—Å—Ç—É—Ä–∞, —Å–æ–∑–¥–∞—é—â–∞—è –æ–±—ä–µ–º–Ω—ã–µ —ç—Ñ—Ñ–µ–∫—Ç—ã –Ω–∞ –ø–æ–≤–µ—Ä—Ö–Ω–æ—Å—Ç–∏. –£–Ω–∏–∫–∞–ª—å–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ –¥–ª—è —ç–∫—Å–∫–ª—é–∑–∏–≤–Ω—ã—Ö –ø—Ä–æ–µ–∫—Ç–æ–≤.",
                "features": ["3D-—Ç–µ–∫—Å—Ç—É—Ä–∞", "–û–±—ä–µ–º–Ω—ã–µ —ç—Ñ—Ñ–µ–∫—Ç—ã", "–ò–Ω–Ω–æ–≤–∞—Ü–∏–æ–Ω–Ω–æ—Å—Ç—å", "–≠–∫—Å–∫–ª—é–∑–∏–≤–Ω–æ—Å—Ç—å"],
                "image_path": "uploads/products/metamorphose_3d.jpg",
                "status": "active"
            }
        ]
        
        # –î–æ–±–∞–≤–ª—è–µ–º –ø—Ä–æ–¥—É–∫—Ç—ã
        for product_data in test_products:
            product = Product(**product_data)
            db.add(product)
            print(f"–î–æ–±–∞–≤–ª–µ–Ω –ø—Ä–æ–¥—É–∫—Ç: {product_data['name']} —Å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ–º: {product_data['image_path']}")
        
        db.commit()
        print(f"‚úÖ –£—Å–ø–µ—à–Ω–æ –¥–æ–±–∞–≤–ª–µ–Ω–æ {len(test_products)} —Ç–µ—Å—Ç–æ–≤—ã—Ö –ø—Ä–æ–¥—É–∫—Ç–æ–≤!")
        
    except Exception as e:
        print(f"‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–∏ –ø—Ä–æ–¥—É–∫—Ç–æ–≤: {e}")
        db.rollback()
    finally:
        db.close()

if __name__ == "__main__":
    print("üöÄ –î–æ–±–∞–≤–ª—è–µ–º —Ç–µ—Å—Ç–æ–≤—ã–µ –ø—Ä–æ–¥—É–∫—Ç—ã...")
    add_test_products()
    print("‚ú® –ì–æ—Ç–æ–≤–æ!")
